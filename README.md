# "–î–µ—Ç–µ–∫—Ü–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫–µ —Å –ø–æ–º–æ—â—å—é YOLO: –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è."

## –ê–Ω–Ω–æ—Ç–∞—Ü–∏—è

–í –¥–∞–Ω–Ω–æ–π —Ä–∞–±–æ—Ç–µ –ø—Ä–æ–≤–µ–¥—É –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ YOLO –ø—Ä–∏ –¥–µ—Ç–µ–∫—Ü–∏–∏ –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫–µ.

**–ê–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å**: –î–µ—Ç–µ–∫—Ü–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫–µ - –≤–∞–∂–Ω–∞—è –∑–∞–¥–∞—á–∞ –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–≥–æ –∑—Ä–µ–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏, —Ç–∞–∫–∏—Ö –∫–∞–∫ –≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ –∏ –∞–≤—Ç–æ–Ω–æ–º–Ω–æ–µ –≤–æ–∂–¥–µ–Ω–∏–µ.

## –ó–∞–¥–∞—á–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤

–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ ‚Äî —ç—Ç–æ –∑–∞–¥–∞—á–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–≥–æ –∑—Ä–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–∞—è –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –ø–æ–∏—Å–∫–µ –æ–±—ä–µ–∫—Ç–æ–≤ –ø—Ä–µ–¥–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤ –Ω–∞ –≤—Ö–æ–¥–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö.

–° —Ä–∞–∑–≤–∏—Ç–∏–µ–º –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ –¥–æ—Å—Ç–∏–≥–ª–æ –≤–µ—Å—å–º–∞ –º–Ω–æ–≥–æ–æ–±–µ—â–∞—é—â–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤. –°—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –∏ –º–æ–¥–µ–ª–µ–π, —Ç–∞–∫–∏—Ö –∫–∞–∫ R-CNN, Faster R-CNN, YOLO –∏ SSD, 
–∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω—ã –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤. –≠—Ç–∏ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –∏ –º–æ–¥–µ–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö, —Ç–∞–∫–∏—Ö –∫–∞–∫ –±–µ—Å–ø–∏–ª–æ—Ç–Ω—ã–µ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏, —Å–∏—Å—Ç–µ–º—ã –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ (object tracking).

### Region-based CNN

–°—É—â–µ—Å—Ç–≤—É–µ—Ç —Ü–µ–ª—ã–π –∫–ª–∞—Å—Å —Å–≤–µ—Ä—Ç–æ—á–Ω—ã—Ö –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ —Ä–µ–≥–∏–æ–Ω–∞—Ö, –æ–±–ª–∞—Å—Ç—è—Ö –∏–ª–∏ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏—Ö —Ä–∞–º–æ–∫.

–û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è —Ç–∞–∫–∏—Ö CNN –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ–±—ã —Å–Ω–∞—á–∞–ª–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–±–æ—Ä –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤ –∏–ª–∏ ¬´–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π —Ä–µ–≥–∏–æ–Ω–æ–≤¬ª –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–ª–∏ –≤–∏–¥–µ–æ, –∞ –∑–∞—Ç–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CNN –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ 
–∫–∞–∂–¥–æ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞ –∫–∞–∫ —Å–æ–¥–µ—Ä–∂–∞—â–µ–≥–æ –æ–±—ä–µ–∫—Ç –∏–ª–∏ –Ω–µ—Ç. –†–µ–≥–∏–æ–Ω—ã, –∫–æ—Ç–æ—Ä—ã–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É—é—Ç—Å—è –∫–∞–∫ —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ –æ–±—ä–µ–∫—Ç, –∑–∞—Ç–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –¥–ª—è —É—Ç–æ—á–Ω–µ–Ω–∏—è –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ –∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –µ–≥–æ –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –∫–ª–∞—Å—Å. 
–≠—Ç–∞ –∫–æ–Ω—Ü–µ–ø—Ü–∏—è —Ç–∞–∫–∂–µ –∏–∑–≤–µ—Å—Ç–Ω–∞ –∫–∞–∫ –¥–≤—É—Ö–∫–∞–¥—Ä–æ–≤–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤.

–û–¥–Ω–∏–º –∏–∑ —Å–∞–º—ã—Ö –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤ CNN –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–≥–∏–æ–Ω–æ–≤ —è–≤–ª—è–µ—Ç—Å—è R-CNN (Regional CNN) –∏ –µ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç—ã, —Ç–∞–∫–∏–µ –∫–∞–∫ Fast R-CNN, Faster R-CNN –∏ Mask R-CNN, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω—ã –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏ —Ç–æ—á–Ω–æ—Å—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤. 
–≠—Ç–∏ –º–µ—Ç–æ–¥—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∫–æ–º–±–∏–Ω–∞—Ü–∏—é –≤—ã–±–æ—Ä–æ—á–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ –∏–ª–∏ –¥—Ä—É–≥–∏—Ö –º–µ—Ç–æ–¥–æ–≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è —Ä–µ–≥–∏–æ–Ω–æ–≤ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ä–µ–≥–∏–æ–Ω–æ–≤-–∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –∏ CNN –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ —É—Ç–æ—á–Ω–µ–Ω–∏—è ‚Äå—Ä–µ–≥–∏–æ–Ω–æ–≤, —Å–æ–¥–µ—Ä–∂–∞—â–∏—Ö –æ–±—ä–µ–∫—Ç—ã.

![–°—Ç—Ä—É–∫—Ç—É—Ä–∞ RCNN](https://github.com/comedian73/Yolo_fish_detekt/blob/main/foto_yolo_/RCNN_structure.png)
**–†–∏—Å. 1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ RCNN**

–ü–æ–¥—Ä–æ–±–Ω–µ–µ —Å–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –º–æ–∂–Ω–æ –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç—å–µ [Faster R-CNN: Towards Real-Time Object
Detection with Region Proposal Networks](https://arxiv.org/pdf/1506.01497). –î–∞–Ω–Ω–∞—è —Å—Ç–∞—Ç—å—è –æ—Ç—Ä–∞–∂–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ—Ç—Ä–∞—Å–ª–∏ –ø–æ CV –Ω–∞ –∫–æ–Ω–µ—Ü 2015 –≥–æ–¥–∞. –ò–º–µ–Ω–Ω–æ –≤ —ç—Ç–æ–º –≥–æ–¥—É –≤—ã—à–ª–∞ –ø–µ—Ä–≤–∞—è –≤–µ—Ä—Å–∏—è –º–æ–¥–µ–ª–∏ YOLO, –æ –∫–æ—Ç–æ—Ä–æ–π –ø–æ–π–¥–µ—Ç —Ä–µ—á—å –Ω–∏–∂–µ.

–ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Ç–æ, —á—Ç–æ Region-based CNN –º–æ–≥—É—Ç —Ä–µ—à–∞—Ç—å –∑–∞–¥–∞—á—É –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ —Å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é, —É –Ω–∏—Ö –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–æ–≤: –≤—ã—Å–æ–∫–∞—è –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å, –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –æ–±–æ–±—â–µ–Ω–∏–µ –∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞. 
–û–Ω–∏ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ –¥–æ—Ä–æ–≥–∏ –∏ –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –∏—Ö –Ω–µ–ø—Ä–∞–∫—Ç–∏—á–Ω—ã–º–∏ –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –º–∞–ª–æ–º–æ—â–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –æ–Ω–∏ —Ç—Ä–µ–±—É—é—Ç –±–æ–ª—å—à–∏—Ö –º–∞—Ä–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –Ω–∞–±–æ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è, –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–æ—Ç–æ—Ä—ã—Ö –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ—Ä–æ–≥–æ—Å—Ç–æ—è—â–∏–º –∏ —Ç—Ä—É–¥–æ–µ–º–∫–∏–º. 
–≠—Ç–∏ —Ñ–∞–∫—Ç–æ—Ä—ã –¥–µ–ª–∞—é—Ç –∏—Ö –º–∞–ª–æ –ø–æ–¥—Ö–æ–¥—è—â–∏–º–∏ –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –≤ –∑–∞–¥–∞—á–∞—Ö –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–≥–æ –∑—Ä–µ–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.

### –ú–µ—Ç—Ä–∏–∫–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤

–î–ª—è –æ—Ü–µ–Ω–∫–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–µ–π –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ –æ–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π:

1. **Mean Average Precision (mAP)**. –¢–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–∞–∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Å—Ç–∏–Ω–Ω–æ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤, –¥–µ–ª–µ–Ω–Ω–æ–µ –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Å—Ç–∏–Ω–Ω–æ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–ª—é—Å –ª–æ–∂–Ω–æ–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.
   –ú–µ—Ç—Ä–∏–∫–∞ mAP —É—á–∏—Ç—ã–≤–∞–µ—Ç –∫–∞–∫ —Ç–æ—á–Ω–æ—Å—Ç—å, —Ç–∞–∫ –∏ –ø–æ–ª–Ω–æ—Ç—É –º–æ–¥–µ–ª–∏ –∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–π —Ç–æ—á–Ω–æ—Å—Ç–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞. –ë–æ–ª–µ–µ –≤—ã—Å–æ–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ mAP —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ª—É—á—à—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏.

3. **Average Precision (AP)**. –≠—Ç–æ –º–µ—Ä–∞ —Ç–æ—á–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —É—Ä–æ–≤–Ω—è—Ö –ø–æ–ª–Ω–æ—Ç—ã. –¢–æ—á–Ω–æ—Å—Ç—å –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–∞–∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Å—Ç–∏–Ω–Ω–æ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤, –¥–µ–ª–µ–Ω–Ω–æ–µ –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Å—Ç–∏–Ω–Ω–æ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–ª—é—Å –ª–æ–∂–Ω–æ–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö.
   –ü–æ–ª–Ω–æ—Ç–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–∞–∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Å—Ç–∏–Ω–Ω–æ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤, –¥–µ–ª–µ–Ω–Ω–æ–µ –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Å—Ç–∏–Ω–Ω–æ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–ª—é—Å –ª–æ–∂–Ω–æ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö. AP —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ –ø–ª–æ—â–∞–¥—å –ø–æ–¥ –∫—Ä–∏–≤–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏-–ø–æ–ª–Ω–æ—Ç—ã. –ë–æ–ª–µ–µ –≤—ã—Å–æ–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ AP —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ª—É—á—à—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏.

5. **Intersection over Union (IoU)**. –≠—Ç–æ –º–µ—Ä–∞ –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏—è –º–µ–∂–¥—É –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–º –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–º –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–æ–º –∏ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–º –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–æ–º –∏—Å—Ç–∏–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è.
   –û–Ω–∞ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –ø—É—Ç–µ–º –¥–µ–ª–µ–Ω–∏—è –ø–ª–æ—â–∞–¥–∏ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è –¥–≤—É—Ö –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–æ–≤ –Ω–∞ –ø–ª–æ—â–∞–¥—å –∏—Ö –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è. –ë–æ–ª–µ–µ –≤—ã—Å–æ–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ IoU —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ª—É—á—à–µ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –º–µ–∂–¥—É –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–º –∏ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–º –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∞–º–∏ –∏—Å—Ç–∏–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è.

![IoU](https://github.com/comedian73/Yolo_fish_detekt/blob/main/foto_yolo_/IoU.png)

### –ö–∞–∫ —Å—á–∏—Ç–∞—Ç—å IoU?

–ü—É—Å—Ç—å —Ä–∞–º–∫–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã –Ω–∞–±–æ—Ä–æ–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç $X$ –∏ $Y$, –≥–¥–µ:

$$ X = (A_1, B_1, C_1, D_1)$$

$$ Y = (A_2, B_2, C_2, D_2)$$

–û–ø—Ä–µ–¥–µ–ª–∏–º $A_{inter}$ –∏ $B_{inter}$ –∫–∞–∫ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤–µ—Ä—Ö–Ω–µ–≥–æ –ª–µ–≤–æ–≥–æ —É–≥–ª–∞ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–µ–≥–æ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∞, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ $C_{inter}$ –∏ $D_{inter}$ - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –Ω–∏–∂–Ω–µ–≥–æ –ø—Ä–∞–≤–æ–≥–æ —É–≥–ª–∞ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–µ–≥–æ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∞.

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º:

$$ A_{inter} = max(A_1, A_2)$$

$$ B_{inter} = max(B_1, B_2)$$

$$ C_{inter} = min(C_1, C_2)$$

$$ D_{inter} = min(D_1, D_2)$$

–ü—Ä–∏ —ç—Ç–æ–º, –µ—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ $(C_{inter}<A_{inter})$ –∏–ª–∏ $(D_{inter}<B_{inter})$, —Ç–æ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ –º–µ–∂–¥—É –¥–≤—É–º—è –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∞–º–∏ —Ä–∞–≤–Ω–æ –Ω—É–ª—é –∏ $$IoU = 0$$.

## –°–µ–º–µ–π—Å—Ç–≤–æ –º–æ–¥–µ–ª–µ–π YOLO

–°–µ–º–µ–π—Å—Ç–≤–æ –º–æ–¥–µ–ª–µ–π ¬´You Only Look Once¬ª –∏–ª–∏ YOLO - —ç—Ç–æ —Å–µ—Ä–∏—è –º–æ–¥–µ–ª–µ–π —Å–∫–≤–æ–∑–Ω–æ–≥–æ –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è, —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –î–∂–æ–∑–µ—Ñ–æ–º –†–µ–¥–º–æ–Ω–æ–º –∏ —Å–æ–∞–≤—Ç–æ—Ä–∞–º–∏ –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏. –û–Ω–∞ –±—ã–ª–∞ –≤–ø–µ—Ä–≤—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –≤ —Å—Ç–∞—Ç—å–µ 2015 –≥–æ–¥–∞ –ø–æ–¥ –Ω–∞–∑–≤–∞–Ω–∏–µ–º –¢—ã —Å–º–æ—Ç—Ä–∏—à—å —Ç–æ–ª—å–∫–æ —Ä–∞–∑: —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏. 
–≠—Ç–æ –æ–¥–Ω–æ—Å—Ç—É–ø–µ–Ω—á–∞—Ç—ã–π –¥–µ—Ç–µ–∫—Ç–æ—Ä –æ–±—ä–µ–∫—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–≤–µ—Ä—Ç–æ—á–Ω—É—é –Ω–µ–π—Ä–æ–Ω–Ω—É—é —Å–µ—Ç—å (CNN) –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏—Ö —Ä–∞–º–æ–∫ –∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –∫–ª–∞—Å—Å–æ–≤ –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ –≤—Ö–æ–¥–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö. –í–ø–µ—Ä–≤—ã–µ YOLO –±—ã–ª —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞ Darknet.

–ê–ª–≥–æ—Ä–∏—Ç–º YOLO –¥–µ–ª–∏—Ç –≤—Ö–æ–¥–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ —Å–µ—Ç–∫—É —è—á–µ–µ–∫, –∏ –¥–ª—è –∫–∞–∂–¥–æ–π —è—á–µ–π–∫–∏ –æ–Ω –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏—è –æ–±—ä–µ–∫—Ç–∞ –∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–µ–π —Ä–∞–º–∫–∏ –æ–±—ä–µ–∫—Ç–∞. 
–û–Ω —Ç–∞–∫–∂–µ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –∫–ª–∞—Å—Å –æ–±—ä–µ–∫—Ç–∞. –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç –¥–≤—É—Ö—Å—Ç—É–ø–µ–Ω—á–∞—Ç—ã—Ö –¥–µ—Ç–µ–∫—Ç–æ—Ä–æ–≤ –æ–±—ä–µ–∫—Ç–æ–≤, —Ç–∞–∫–∏—Ö –∫–∞–∫ R-CNN –∏ –µ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç—ã, YOLO –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–∞ –æ–¥–∏–Ω –ø—Ä–æ—Ö–æ–¥, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –µ–≥–æ –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä—ã–º –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º.

YOLO –±—ã–ª —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤–µ—Ä—Å–∏—è—Ö, –Ω–∞—á–∏–Ω–∞—è —Å YOLOv1 –∏ –ø–æ YOLOv11! –í—Å–µ –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ –º–µ–Ω—è–µ—Ç—Å—è, –ø–æ—ç—Ç–æ–º—É —Å–ª–µ–¥–∏—Ç–µ –∑–∞ YOLO –Ω–∞ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–º —Å–∞–π—Ç–µ. 
–ö–∞–∂–¥–∞—è –≤–µ—Ä—Å–∏—è –±—ã–ª–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –ø–æ–≤–µ—Ä—Ö –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏ —Å —É–ª—É—á—à–µ–Ω–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏, —Ç–∞–∫–∏–º–∏ –∫–∞–∫ —É–ª—É—á—à–µ–Ω–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å, –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏ –ª—É—á—à–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤.

YOLO —à–∏—Ä–æ–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö, —Ç–∞–∫–∏—Ö –∫–∞–∫ –±–µ—Å–ø–∏–ª–æ—Ç–Ω—ã–µ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏ –∏ —Å–∏—Å—Ç–µ–º—ã –Ω–∞–±–ª—é–¥–µ–Ω–∏—è. 
–û–Ω —Ç–∞–∫–∂–µ —à–∏—Ä–æ–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∑–∞–¥–∞—á –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏, —Ç–∞–∫–∏—Ö –∫–∞–∫ –≤–∏–¥–µ–æ–∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –∏ –≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.

### –ê–ª–≥–æ—Ä–∏—Ç–º YOLO: –∫–∞–∫ –æ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç?

–û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è YOLO –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ–±—ã —Ä–∞–∑–¥–µ–ª–∏—Ç—å –≤—Ö–æ–¥–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ —Å–µ—Ç–∫—É —è—á–µ–µ–∫ –∏ –¥–ª—è –∫–∞–∂–¥–æ–π —è—á–µ–π–∫–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏—è –æ–±—ä–µ–∫—Ç–∞ –∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–µ–≥–æ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∞ –æ–±—ä–µ–∫—Ç–∞. –ü—Ä–æ—Ü–µ—Å—Å YOLO –º–æ–∂–Ω–æ —Ä–∞–∑–±–∏—Ç—å –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç—Ç–∞–ø–æ–≤:

–í—Ö–æ–¥–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ —Å–≤–µ—Ä—Ç–æ—á–Ω—É—é –Ω–µ–π—Ä–æ–Ω–Ω—É—é —Å–µ—Ç—å –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.

–ó–∞—Ç–µ–º –æ–±—ä–µ–∫—Ç—ã –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ —Ä—è–¥ –ø–æ–ª–Ω–æ—Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å–ª–æ–µ–≤, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—é—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –∫–ª–∞—Å—Å–æ–≤ –∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–µ–π —Ä–∞–º–∫–∏.

–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–æ –Ω–∞ —Å–µ—Ç–∫—É —è—á–µ–µ–∫, –∫–∞–∂–¥–∞—è –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞–±–æ—Ä–∞ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏—Ö —Ä–∞–º–æ–∫ –∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –∫–ª–∞—Å—Å–æ–≤.

–í—ã—Ö–æ–¥ —Å–µ—Ç–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –Ω–∞–±–æ—Ä –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏—Ö —Ä–∞–º–æ–∫ –∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –∫–ª–∞—Å—Å–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–π —è—á–µ–π–∫–∏.

–ó–∞—Ç–µ–º –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–µ —Ä–∞–º–∫–∏ —Ñ–∏–ª—å—Ç—Ä—É—é—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –ø–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∏, –Ω–∞–∑—ã–≤–∞–µ–º–æ–≥–æ –Ω–µ–º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º –ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ–º, –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—é—â–∏—Ö—Å—è —Ä–∞–º–æ–∫ –∏ –≤—ã–±–æ—Ä–∞ —Ä–∞–º–∫–∏ —Å –Ω–∞–∏–±–æ–ª—å—à–µ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é.

–ö–æ–Ω–µ—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç ‚Äî –Ω–∞–±–æ—Ä –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º—ã—Ö –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏—Ö —Ä–∞–º–æ–∫ –∏ –º–µ—Ç–æ–∫ –∫–ª–∞—Å—Å–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏.

–û–¥–Ω–∏–º –∏–∑ –∫–ª—é—á–µ–≤—ã—Ö –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤ YOLO —è–≤–ª—è–µ—Ç—Å—è —Ç–æ, —á—Ç–æ –æ–Ω –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–∞ –æ–¥–∏–Ω –ø—Ä–æ—Ö–æ–¥, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –µ–≥–æ –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä—ã–º –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º, —á–µ–º –¥–≤—É—Ö—Å—Ç—É–ø–µ–Ω—á–∞—Ç—ã–µ –¥–µ—Ç–µ–∫—Ç–æ—Ä—ã –æ–±—ä–µ–∫—Ç–æ–≤, —Ç–∞–∫–∏–µ –∫–∞–∫ R-CNN –∏ –µ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç—ã.

![–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ YOLOv1](https://github.com/comedian73/Yolo_fish_detekt/blob/main/foto_yolo_/Yolo_architecture.png)
**–†–∏—Å. 2. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ YOLOv1**

*C–µ—Ç—å –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ 24 —Å–≤–µ—Ä—Ç–æ—á–Ω—ã—Ö —Å–ª–æ–µ–≤, –∑–∞ –∫–æ—Ç–æ—Ä—ã–º–∏ —Å–ª–µ–¥—É—é—Ç 2 –ø–æ–ª–Ω–æ—Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å–ª–æ—è. 
–ß–µ—Ä–µ–¥—É—é—â–∏–µ—Å—è —Å–≤–µ—Ä—Ç–æ—á–Ω—ã–µ —Å–ª–æ–∏ —Ä–∞–∑–º–µ—Ä–æ–º 1 √ó 1 —É–º–µ–Ω—å—à–∞—é—Ç –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏ —Å–ª–æ—è–º–∏. 
–°–≤–µ—Ä—Ç–æ—á–Ω—ã–µ —Å–ª–æ–∏ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ–±—É—á–µ–Ω—ã –≤ –∑–∞–¥–∞—á–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–∞ –¥–∞—Ç–∞—Å–µ—Ç–µ ImageNet —Å –ø–æ–ª–æ–≤–∏–Ω–Ω—ã–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ–º (–≤—Ö–æ–¥–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ 224 √ó 224), –∞ –¥–ª—è –∑–∞–¥–∞—á–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ —É–¥–≤–∞–∏–≤–∞–µ—Ç—Å—è. 
–†–∏—Å—É–Ω–æ–∫ –≤–∑—è—Ç –∏–∑ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç—å–∏.*

## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞

–í –¥–∞–Ω–Ω–æ–π —Å—Ç–∞—Ç—å–µ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –º–æ–¥–µ–ª—å YOLOv11. –û–Ω–∞ –±—É–¥–µ—Ç –¥–æ–æ–±—É—á–µ–Ω–∞ –Ω–∞ –¥–∞—Ç–∞—Å–µ—Ç–µ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∫—Ä–æ–º–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö.

–¢–∞–∫ –∂–µ –æ–±—É—á–∏–º –≤—Ç–æ—Ä—É—é –º–æ–¥–µ–ª—å —Å –±–æ–ª–µ–µ —à–∏—Ä–æ–∫–∏–º —Å–ø–∏—Å–∫–æ–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –∏ –ø–æ—Å–º–æ—Ç—Ä–∏–º –∫–∞–∫ –æ–Ω–∏ –æ—Ç–ª—å—á–∞—é—Ç—Å—è –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞. –†–∞—Å–ø–æ–∑–Ω–∞–µ–º –æ–±—ä–µ–∫—Ç—ã –Ω–∞ –≤–∏–¥–µ–æ –∏ –ø–æ—Å—á–∏—Ç–∞–µ–º —Å–∫–æ–ª—å–∫–æ –∫–∞–∂–¥–∞—è –º–æ–¥–µ–ª—å –æ–±–Ω–æ—Ä—É–∂–∏–ª–∞ –æ–±—ä–µ–∫—Ç–æ–≤.

–í –∫–∞—á–µ—Å—Ç–≤–µ –æ–±—ä–µ–∫—Ç–æ–≤ –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–æ–≤–∞–Ω–∏—è –±—É–¥—É—Ç —Ä—ã–±–∫–∏. –î–∞, —Ç–µ —Å–∞–º—ã–µ –∞–∫–≤–∞—Ä–∏—É–º–Ω—ã–µ –∂–∏—Ç–µ–ª–∏ –∫–æ—Ç–æ—Ä—ã–µ —Å—á–∏—Ç–∞—é—Ç—Å—è –æ–¥–Ω–∏–º–∏ –∏–∑ –ª—É—á—à–∏—Ö —Ä–µ–ª–æ–∫—Å–∞—Ç–æ—Ä–∞–º–∏ üêü üêü

–î–ª—è —Ä–∞–±–æ—Ç—ã —Å –º–æ–¥–µ–ª—è–º–∏, –¥–∞—Ç–∞—Å–µ—Ç–∞–º–∏ –∏ –æ–±—â–µ–π –ª–æ–≥–∏–∫–æ–π, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫–∏.
```Python
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–∞ ultralytics –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π YOLO
!pip install ultralytics
```
```Python
import ultralytics                    # –ø–∞–∫–µ—Ç–∞ ultralytics –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å YOLO
from ultralytics import YOLO          # –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –∑–∞–≥—Ä—É–∑—á–∏–∫ –º–æ–¥–µ–ª–µ–π YOLO

from tqdm import tqdm                 # –ø—Ä–æ–≥—Ä–µ—Å—Å –±–∞—Ä
import os                             # –ø–∞–∫–µ—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π
import numpy as np                    # –ª–∏–Ω–µ–π–Ω–∞—è –∞–ª–≥–µ–±—Ä–∞
import cv2                            # –º–æ—â–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
import glob                           # –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∏—Ä–∏–∫—Ç–æ—Ä–∏—è–º–∏
import matplotlib.pyplot as plt       # –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è, –≥—Ä–∞—Ñ–∏–∫–∏
from moviepy.editor import *          # –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –≤–∏–¥–µ–æ

import warnings                       # –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è–º–∏
warnings.filterwarnings('ignore')     # —Ñ–∏–ª—å—Ç—Ä–∏—Ä—É–µ–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

ultralytics.checks()                  # –ø—Ä–æ—Å–º–æ—Ç—Ä –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å—Ä–µ–¥–µ
```
```Python
# –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫—É –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Google –î–∏—Å–∫–æ–º
# –ß—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ –∑–∞–≥—Ä—É–∂–∞—Ç—å —Ñ–∞–π–ª—ã
from google.colab import drive
drive.mount('/content/drive')
```

–°—Ä–∞–∑—É –æ–ø—Ä–µ–¥–µ–ª–∏–º –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏.

–§—É–Ω–∫—Ü–∏—è –¥–µ—Ç–µ–∫—Ü–∏–∏ –æ–±—å–µ–∫—Ç–æ–≤ –±—ã–ª–∞ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞ –∏–∑ —Å—Ç–∞—Ç—å–∏ –Ω–∞ [Habr](https://habr.com/ru/articles/821971/) 

–¢–∞–∫ –∂–µ –ø–æ–¥–æ–±–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –≤ "–ª–µ–≥–∫–æ–º" –≤–∞—Ä–∏–∞–Ω—Ç–µ, –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –Ω–∞ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–º —Å–∞–π—Ç–µ [Ultralytics](https://ultralytics.com)

```Python
# –§—É–Ω–∫—Ü–∏—è –¥–µ—Ç–µ–∫—Ü–∏–∏ –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –≤–∏–¥–µ–æ –∏ –≤–æ–∑–≤—Ä–∞—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã—Ö —Ä—ã–±–æ–∫ –≤–æ –≤—Å–µ—Ö –∫–∞–¥—Ä–∞—Ö
def detect_in_video(model, input, output):
    '''
    –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –æ–±—ä–µ–∫—Ç—ã –Ω–∞ –≤–∏–¥–µ–æ.
    @param model:  –º–æ–¥–µ–ª—å YOLO —Å –ø–æ–º–æ—â—å—é –∫–æ—Ç–æ—Ä–æ–π –±—É–¥–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è
                   –¥–µ—Ç–µ–∫—Ü–∏—è –æ–±—ä–µ–∫—Ç–æ–≤/
    @param input:  —Å—Ç—Ä–æ–∫–∞ —É–∫–∞–∑—ã–≤–∞—é—â–∞—è –ø—É—Ç—å –∫ –≤–∏–¥–µ–æ—Ñ–∞–π–ª—É —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –≤ –∫–æ—Ç–æ—Ä–æ–º
                   –±—É–¥–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è –¥–µ—Ç–µ–∫—Ü–∏—è.
                   –ü—Ä–∏–º–µ—Ä: '/content/drive/MyDrive/video.mp4'
    @param output: —Å—Ç—Ä–æ–∫–∞ —É–∫–∞–∑—ã–≤–∞—é—â–∞—è –ø—É—Ç—å –∫ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ–º—É –≤–∏–¥–µ–æ—Ñ–∞–π–ª—É —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º.
                   –ü—Ä–∏–º–µ—Ä: 'detect.mp4'
    '''

    colors = [
      (255, 0, 0), (0, 255, 0)
      ]

    # –û—Ç–∫—Ä—ã—Ç–∏–µ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –≤–∏–¥–µ–æ—Ñ–∞–π–ª–∞
    capture = cv2.VideoCapture(input)

    # –ü–æ–ª—É—á–µ–Ω–∏–µ –æ–±—â–µ–≥–æ —á–∏—Å–ª–∞ –∫–∞–¥—Ä–æ–≤ –≤ –≤–∏–¥–µ–æ
    frame_number = int(capture.get(cv2.CAP_PROP_FRAME_COUNT))

    # –ß—Ç–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤–∏–¥–µ–æ
    fps = int(capture.get(cv2.CAP_PROP_FPS))
    width = int(capture.get(cv2.CAP_PROP_FRAME_WIDTH))
    height = int(capture.get(cv2.CAP_PROP_FRAME_HEIGHT))

    # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
    fourcc = cv2.VideoWriter_fourcc(*'mp4v')
    writer = cv2.VideoWriter(output, fourcc, fps, (width, height))

    sum_fish = 0

    for i in tqdm(range(frame_number-1), ncols=80, ascii=True, desc='–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∏–¥–µ–æ'):

        # –ó–∞—Ö–≤–∞—Ç –∫–∞–¥—Ä–∞
        ret, frame = capture.read()
        if not ret:
           break
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞–¥—Ä–∞ —Å –ø–æ–º–æ—â—å—é –º–æ–¥–µ–ª–∏ YOLO
        results = model(frame, verbose=False)[0]

        # –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ–± –æ–±—ä–µ–∫—Ç–∞—Ö
        classes_names = results.names
        classes = results.boxes.cls.cpu().numpy()
        boxes = results.boxes.xyxy.cpu().numpy().astype(np.int32)

        # –†–∏—Å–æ–≤–∞–Ω–∏–µ —Ä–∞–º–æ–∫ –∏ –ø–æ–¥–ø–∏—Å–µ–π –Ω–∞ –∫–∞–¥—Ä–µ
        for class_id, box, conf in zip(classes, boxes, results.boxes.conf):
            if conf>0.7: # –µ—Å–ª–∏ —Ç–æ—á–Ω–æ—Å—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –≤—ã—à–µ 70%
               class_name = classes_names[int(class_id)] +  " {:.2f}".format(float(conf))
               color = colors[int(class_id) % len(colors)]
               x1, y1, x2, y2 = box
               cv2.rectangle(frame, (x1, y1), (x2, y2), color, 2)
               cv2.putText(frame, class_name, (x1, y1 - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, color, 2)

               sum_fish += len(boxes) # —Å–∫–ª–∞–¥—ã–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω—ã—Ö —Ä—ã–±–æ–∫ –≤ –∫–∞–¥—Ä–µ

        # –ó–∞–ø–∏—Å—å –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–≥–æ –∫–∞–¥—Ä–∞ –≤ –≤—ã—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª
        writer.write(frame)

    # –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤ –∏ –∑–∞–∫—Ä—ã—Ç–∏–µ –æ–∫–æ–Ω
    capture.release()
    writer.release()
    return '–°—É–º–º–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–∏–π –Ω–∞ –≤—Å–µ—Ö –∫–∞–¥—Ä–∞—Ö: ' + str(sum_fish)
```
```Puthon
# —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã–≤–æ–¥–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ –º–µ—Ç—Ä–∏–∫
def result_train(path):
    img = cv2.imread(path)
    plt.figure(figsize=(8,8), dpi= 150)
    plt.imshow(img)
```

[–î–∞—Ç–∞—Å–µ—Ç](https://universe.roboflow.com/objectdetection-dwyrp/ornamental-fish-detection/dataset/4) –±—ã–ª —Å–∫–∞—á–∞–Ω —Å —Å–∞–π—Ç–∞ [roboflow](https://roboflow.com/) –∏ –¥–æ–±–∞–≤–ª–µ–Ω –Ω–∞ [Google Drive](https://drive.google.com/file/d/11tTUNTSwWFQWRJSXXfso93qxDi2gLtM5/view?usp=drive_link)

```Python
# —Ä–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ–º –∞—Ä—Ö–∏–≤ –¥–∞—Ç–∞—Å–µ—Ç–∞ –≤ –ø–∞–ø–∫—É fish
!unzip -d 'fish' -qo "/content/drive/MyDrive/fish.zip"

# –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –ø—É—Ç—å –¥–æ —Ñ–∞–π–ª–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–∞—Ç–∞—Å–µ—Ç–∞
yaml_path = './fish/data.yaml'
```
